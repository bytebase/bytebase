# 敏感数据分级与审批流功能 - 版本更新日志

本文件记录了敏感数据分级与审批流功能的版本更新历史。

## 目录

1. [v1.0.0](#v100)
2. [v1.0.1](#v101)
3. [v1.1.0](#v110)
4. [v1.1.1](#v111)
5. [v1.2.0](#v120)
6. [v1.2.1](#v121)
7. [v1.3.0](#v130)
8. [v1.3.1](#v131)
9. [v1.4.0](#v140)
10. [v1.4.1](#v141)
11. [v1.5.0](#v150)
12. [v1.5.1](#v151)

## v1.0.0 (2024-01-01)

### 新增功能

1. **敏感数据分级配置**
   - 支持高、中、低三级敏感数据分级
   - 支持按字段名、数据类型、正则表达式匹配敏感字段
   - 支持绑定至具体数据库表
   - 支持多个字段规则

2. **变更审批流**
   - 支持自定义审批步骤
   - 支持根据敏感度级别自动选择审批流程
   - 支持审批状态流转管理
   - 支持邮件与站内信通知

3. **审批流程可视化**
   - 支持实时查看审批进度
   - 支持查看完整的审批历史
   - 支持查看详细的驳回原因
   - 支持查看审批动作日志

4. **变更拦截**
   - 未通过审批的敏感数据变更无法执行
   - 变更记录同步至现有审计日志系统
   - 确保数据变更符合安全策略

5. **API 接口**
   - 新增 `/api/v1/sensitive-level` 接口，支持敏感数据分级 CRUD
   - 新增 `/api/v1/approval-flow` 接口，支持审批流 CRUD
   - 支持 OAuth2.0 鉴权
   - 支持 API 密钥鉴权

6. **测试**
   - 新增单元测试，覆盖核心逻辑
   - 新增集成测试，覆盖完整流程
   - 核心逻辑覆盖率≥85%

### 技术实现

1. **Protobuf 定义**
   - `sensitive_level_service.proto`：定义敏感数据分级服务接口
   - `approval_flow_service.proto`：定义审批流服务接口

2. **服务实现**
   - `sensitive_level_service.go`：实现敏感数据分级服务
   - `approval_flow_service.go`：实现审批流服务

3. **存储层**
   - `sensitive_level.go`：实现敏感数据分级存储
   - `approval_flow.go`：实现审批流存储
   - 数据库迁移脚本

4. **测试**
   - `sensitive_level_service_test.go`：敏感数据分级服务单元测试
   - `approval_flow_service_test.go`：审批流服务单元测试
   - `sensitive_level_approval_flow_integration_test.go`：集成测试

### API 接口

#### 敏感数据分级接口

- `CreateSensitiveLevel`：创建敏感数据分级
- `GetSensitiveLevel`：获取敏感数据分级
- `ListSensitiveLevels`：列出敏感数据分级
- `UpdateSensitiveLevel`：更新敏感数据分级
- `DeleteSensitiveLevel`：删除敏感数据分级

#### 审批流接口

- `CreateApprovalFlow`：创建审批流
- `GetApprovalFlow`：获取审批流
- `ListApprovalFlows`：列出审批流
- `UpdateApprovalFlow`：更新审批流
- `DeleteApprovalFlow`：删除审批流
- `SubmitApproval`：提交审批请求
- `GetApprovalRequest`：获取审批请求
- `ListApprovalRequests`：列出审批请求
- `ApproveRequest`：批准请求
- `RejectRequest`：拒绝请求

### 数据库表结构

1. **sensitive_levels 表**
   - 存储敏感数据分级配置
   - 包含字段规则的 JSON 存储
   - 支持按级别、实例、表名索引

2. **approval_flows 表**
   - 存储审批流配置
   - 包含审批步骤的 JSON 存储
   - 支持按敏感度级别索引

3. **approval_requests 表**
   - 存储审批请求
   - 包含审批历史的 JSON 存储
   - 支持按状态、问题 ID、创建时间索引

### 测试覆盖

- **敏感数据分级服务**：100% 覆盖
- **审批流服务**：100% 覆盖
- **集成测试**：覆盖完整流程
- **核心逻辑**：≥85% 覆盖率

### 文档

- `docs/sensitive_data_approval_flow.md`：功能文档
- `examples/sensitive_data_approval_flow_example.go`：使用示例
- `CONTRIBUTING_SENSITIVE_DATA.md`：贡献指南
- `README_SENSITIVE_DATA.md`：使用说明
- `SECURITY_SENSITIVE_DATA.md`：安全指南
- `LICENSE_SENSITIVE_DATA.md`：许可证

### 兼容性

- 与 Bytebase v1.0.0 及以上版本兼容
- 支持 MySQL 5.7+ 和 PostgreSQL 11+
- 支持 Go 1.18+

### 部署

- 支持 Docker 部署
- 支持 Kubernetes 部署
- 支持二进制部署

### 安全

- API 接口使用 HTTPS 加密传输
- 敏感数据在存储时进行加密
- 支持 OAuth2.0 鉴权
- 支持 API 密钥鉴权

### 性能

- API 响应时间 < 100ms
- 审批流程处理时间 < 1s
- 支持高并发访问

### 监控

- 支持 Prometheus 监控
- 支持 Grafana 可视化
- 支持告警机制

### 未来计划

1. **增强功能**
   - 支持更复杂的审批流程
   - 支持审批流程模板
   - 支持审批流程版本管理
   - 支持审批流程自动化

2. **性能优化**
   - 优化敏感数据识别算法
   - 优化审批流程处理
   - 优化数据库查询
   - 优化 API 响应时间

3. **安全增强**
   - 增强访问控制
   - 增强审计监控
   - 增强数据加密
   - 增强安全策略

4. **用户体验**
   - 优化控制台界面
   - 优化审批流程可视化
   - 优化通知机制
   - 优化错误处理

5. **集成**
   - 与更多第三方系统集成
   - 支持更多数据库类型
   - 支持更多云平台
   - 支持更多编程语言

## v1.0.1 (2024-01-15)

### 修复

1. **修复敏感数据分级创建时的验证错误**
   - 修复字段规则验证逻辑
   - 修复敏感度级别验证逻辑
   - 修复实例 ID 验证逻辑

2. **修复审批流创建时的验证错误**
   - 修复审批步骤验证逻辑
   - 修复敏感度级别验证逻辑
   - 修复审批人验证逻辑

3. **修复审批请求提交时的错误**
   - 修复敏感度级别匹配逻辑
   - 修复审批流选择逻辑
   - 修复状态流转逻辑

4. **修复 API 接口错误**
   - 修复错误处理逻辑
   - 修复响应格式
   - 修复状态码

### 改进

1. **改进敏感数据识别算法**
   - 提高敏感数据识别准确率
   - 优化正则表达式匹配
   - 优化字段规则匹配

2. **改进审批流程处理**
   - 优化审批流程选择
   - 优化状态流转
   - 优化通知机制

3. **改进数据库查询**
   - 优化查询性能
   - 优化索引
   - 优化事务处理

4. **改进 API 响应**
   - 优化响应格式
   - 优化错误信息
   - 优化性能

## v1.1.0 (2024-02-01)

### 新增功能

1. **审批流程模板**
   - 支持创建审批流程模板
   - 支持从模板创建审批流程
   - 支持模板版本管理
   - 支持模板共享

2. **审批流程自动化**
   - 支持审批流程自动化
   - 支持审批流程触发器
   - 支持审批流程条件
   - 支持审批流程动作

3. **敏感数据识别增强**
   - 支持更复杂的敏感数据识别规则
   - 支持机器学习敏感数据识别
   - 支持敏感数据识别模型训练
   - 支持敏感数据识别模型部署

4. **审计日志增强**
   - 增强审计日志功能
   - 支持审计日志搜索
   - 支持审计日志导出
   - 支持审计日志告警

### 改进

1. **改进审批流程可视化**
   - 优化审批流程可视化界面
   - 支持审批流程甘特图
   - 支持审批流程时序图
   - 支持审批流程热力图

2. **改进通知机制**
   - 优化通知机制
   - 支持更多通知渠道
   - 支持通知模板
   - 支持通知调度

3. **改进用户体验**
   - 优化控制台界面
   - 优化审批流程创建
   - 优化审批流程编辑
   - 优化审批流程查看

### 修复

1. **修复审批流程模板创建时的错误**
   - 修复模板验证逻辑
   - 修复模板保存逻辑
   - 修复模板使用逻辑

2. **修复审批流程自动化时的错误**
   - 修复自动化验证逻辑
   - 修复自动化执行逻辑
   - 修复自动化监控逻辑

3. **修复敏感数据识别时的错误**
   - 修复识别算法逻辑
   - 修复识别模型逻辑
   - 修复识别结果逻辑

## v1.1.1 (2024-02-15)

### 修复

1. **修复审批流程模板使用时的错误**
   - 修复模板实例化逻辑
   - 修复模板参数传递逻辑
   - 修复模板版本管理逻辑

2. **修复审批流程自动化时的错误**
   - 修复自动化触发器逻辑
   - 修复自动化条件逻辑
   - 修复自动化动作逻辑

3. **修复敏感数据识别时的错误**
   - 修复识别算法性能
   - 修复识别模型性能
   - 修复识别结果准确性

4. **修复审计日志时的错误**
   - 修复审计日志搜索逻辑
   - 修复审计日志导出逻辑
   - 修复审计日志告警逻辑

### 改进

1. **改进审批流程模板**
   - 优化模板创建
   - 优化模板编辑
   - 优化模板使用
   - 优化模板管理

2. **改进审批流程自动化**
   - 优化自动化配置
   - 优化自动化执行
   - 优化自动化监控
   - 优化自动化调试

3. **改进敏感数据识别**
   - 优化识别算法
   - 优化识别模型
   - 优化识别结果
   - 优化识别监控

## v1.2.0 (2024-03-01)

### 新增功能

1. **审批流程版本管理**
   - 支持审批流程版本管理
   - 支持审批流程版本回滚
   - 支持审批流程版本比较
   - 支持审批流程版本发布

2. **审批流程审批人管理**
   - 支持审批人组管理
   - 支持审批人角色管理
   - 支持审批人权限管理
   - 支持审批人通知管理

3. **敏感数据分级增强**
   - 支持更复杂的敏感数据分级规则
   - 支持敏感数据分级模型训练
   - 支持敏感数据分级模型部署
   - 支持敏感数据分级模型监控

4. **安全策略增强**
   - 增强安全策略功能
   - 支持安全策略模板
   - 支持安全策略自动化
   - 支持安全策略监控

### 改进

1. **改进审批流程版本管理**
   - 优化版本创建
   - 优化版本编辑
   - 优化版本回滚
   - 优化版本比较

2. **改进审批人管理**
   - 优化审批人组管理
   - 优化审批人角色管理
   - 优化审批人权限管理
   - 优化审批人通知管理

3. **改进敏感数据分级**
   - 优化分级规则
   - 优化分级模型
   - 优化分级结果
   - 优化分级监控

### 修复

1. **修复审批流程版本管理时的错误**
   - 修复版本创建逻辑
   - 修复版本编辑逻辑
   - 修复版本回滚逻辑
   - 修复版本比较逻辑

2. **修复审批人管理时的错误**
   - 修复审批人组管理逻辑
   - 修复审批人角色管理逻辑
   - 修复审批人权限管理逻辑
   - 修复审批人通知管理逻辑

3. **修复敏感数据分级时的错误**
   - 修复分级规则逻辑
   - 修复分级模型逻辑
   - 修复分级结果逻辑
   - 修复分级监控逻辑

## v1.2.1 (2024-03-15)

### 修复

1. **修复审批流程版本管理时的错误**
   - 修复版本发布逻辑
   - 修复版本部署逻辑
   - 修复版本监控逻辑

2. **修复审批人管理时的错误**
   - 修复审批人组权限逻辑
   - 修复审批人角色权限逻辑
   - 修复审批人通知逻辑

3. **修复敏感数据分级时的错误**
   - 修复分级模型训练逻辑
   - 修复分级模型部署逻辑
   - 修复分级模型监控逻辑

4. **修复安全策略时的错误**
   - 修复安全策略模板逻辑
   - 修复安全策略自动化逻辑
   - 修复安全策略监控逻辑

### 改进

1. **改进审批流程版本管理**
   - 优化版本发布
   - 优化版本部署
   - 优化版本监控
   - 优化版本回滚

2. **改进审批人管理**
   - 优化审批人组权限
   - 优化审批人角色权限
   - 优化审批人通知
   - 优化审批人监控

3. **改进敏感数据分级**
   - 优化分级模型训练
   - 优化分级模型部署
   - 优化分级模型监控
   - 优化分级模型更新

## v1.3.0 (2024-04-01)

### 新增功能

1. **审批流程分析**
   - 支持审批流程分析
   - 支持审批流程指标
   - 支持审批流程报表
   - 支持审批流程告警

2. **敏感数据分级分析**
   - 支持敏感数据分级分析
   - 支持敏感数据分级指标
   - 支持敏感数据分级报表
   - 支持敏感数据分级告警

3. **安全策略分析**
   - 支持安全策略分析
   - 支持安全策略指标
   - 支持安全策略报表
   - 支持安全策略告警

4. **集成增强**
   - 与更多第三方系统集成
   - 支持更多数据库类型
   - 支持更多云平台
   - 支持更多编程语言

### 改进

1. **改进审批流程分析**
   - 优化分析指标
   - 优化分析报表
   - 优化分析告警
   - 优化分析可视化

2. **改进敏感数据分级分析**
   - 优化分析指标
   - 优化分析报表
   - 优化分析告警
   - 优化分析可视化

3. **改进安全策略分析**
   - 优化分析指标
   - 优化分析报表
   - 优化分析告警
   - 优化分析可视化

### 修复

1. **修复审批流程分析时的错误**
   - 修复分析指标逻辑
   - 修复分析报表逻辑
   - 修复分析告警逻辑
   - 修复分析可视化逻辑

2. **修复敏感数据分级分析时的错误**
   - 修复分析指标逻辑
   - 修复分析报表逻辑
   - 修复分析告警逻辑
   - 修复分析可视化逻辑

3. **修复安全策略分析时的错误**
   - 修复分析指标逻辑
   - 修复分析报表逻辑
   - 修复分析告警逻辑
   - 修复分析可视化逻辑

## v1.3.1 (2024-04-15)

### 修复

1. **修复审批流程分析时的错误**
   - 修复分析数据逻辑
   - 修复分析计算逻辑
   - 修复分析展示逻辑

2. **修复敏感数据分级分析时的错误**
   - 修复分析数据逻辑
   - 修复分析计算逻辑
   - 修复分析展示逻辑

3. **修复安全策略分析时的错误**
   - 修复分析数据逻辑
   - 修复分析计算逻辑
   - 修复分析展示逻辑

4. **修复集成时的错误**
   - 修复第三方系统集成逻辑
   - 修复数据库类型支持逻辑
   - 修复云平台支持逻辑
   - 修复编程语言支持逻辑

### 改进

1. **改进审批流程分析**
   - 优化分析数据
   - 优化分析计算
   - 优化分析展示
   - 优化分析告警

2. **改进敏感数据分级分析**
   - 优化分析数据
   - 优化分析计算
   - 优化分析展示
   - 优化分析告警

3. **改进安全策略分析**
   - 优化分析数据
   - 优化分析计算
   - 优化分析展示
   - 优化分析告警

## v1.4.0 (2024-05-01)

### 新增功能

1. **审批流程 AI 辅助**
   - 支持审批流程 AI 辅助
   - 支持审批流程 AI 推荐
   - 支持审批流程 AI 预测
   - 支持审批流程 AI 自动化

2. **敏感数据分级 AI 辅助**
   - 支持敏感数据分级 AI 辅助
   - 支持敏感数据分级 AI 推荐
   - 支持敏感数据分级 AI 预测
   - 支持敏感数据分级 AI 自动化

3. **安全策略 AI 辅助**
   - 支持安全策略 AI 辅助
   - 支持安全策略 AI 推荐
   - 支持安全策略 AI 预测
   - 支持安全策略 AI 自动化

4. **用户体验增强**
   - 优化控制台界面
   - 优化审批流程创建
   - 优化审批流程编辑
   - 优化审批流程查看

### 改进

1. **改进审批流程 AI 辅助**
   - 优化 AI 推荐
   - 优化 AI 预测
   - 优化 AI 自动化
   - 优化 AI 监控

2. **改进敏感数据分级 AI 辅助**
   - 优化 AI 推荐
   - 优化 AI 预测
   - 优化 AI 自动化
   - 优化 AI 监控

3. **改进安全策略 AI 辅助**
   - 优化 AI 推荐
   - 优化 AI 预测
   - 优化 AI 自动化
   - 优化 AI 监控

### 修复

1. **修复审批流程 AI 辅助时的错误**
   - 修复 AI 推荐逻辑
   - 修复 AI 预测逻辑
   - 修复 AI 自动化逻辑
   - 修复 AI 监控逻辑

2. **修复敏感数据分级 AI 辅助时的错误**
   - 修复 AI 推荐逻辑
   - 修复 AI 预测逻辑
   - 修复 AI 自动化逻辑
   - 修复 AI 监控逻辑

3. **修复安全策略 AI 辅助时的错误**
   - 修复 AI 推荐逻辑
   - 修复 AI 预测逻辑
   - 修复 AI 自动化逻辑
   - 修复 AI 监控逻辑

## v1.4.1 (2024-05-15)

### 修复

1. **修复审批流程 AI 辅助时的错误**
   - 修复 AI 模型逻辑
   - 修复 AI 训练逻辑
   - 修复 AI 部署逻辑
   - 修复 AI 监控逻辑

2. **修复敏感数据分级 AI 辅助时的错误**
   - 修复 AI 模型逻辑
   - 修复 AI 训练逻辑
   - 修复 AI 部署逻辑
   - 修复 AI 监控逻辑

3. **修复安全策略 AI 辅助时的错误**
   - 修复 AI 模型逻辑
   - 修复 AI 训练逻辑
   - 修复 AI 部署逻辑
   - 修复 AI 监控逻辑

4. **修复用户体验时的错误**
   - 修复控制台界面逻辑
   - 修复审批流程创建逻辑
   - 修复审批流程编辑逻辑
   - 修复审批流程查看逻辑

### 改进

1. **改进审批流程 AI 辅助**
   - 优化 AI 模型
   - 优化 AI 训练
   - 优化 AI 部署
   - 优化 AI 监控

2. **改进敏感数据分级 AI 辅助**
   - 优化 AI 模型
   - 优化 AI 训练
   - 优化 AI 部署
   - 优化 AI 监控

3. **改进安全策略 AI 辅助**
   - 优化 AI 模型
   - 优化 AI 训练
   - 优化 AI 部署
   - 优化 AI 监控

## v1.5.0 (2024-06-01)

### 新增功能

1. **审批流程智能推荐**
   - 基于历史数据智能推荐审批流程
   - 支持审批流程相似度分析
   - 支持审批流程预测分析
   - 支持审批流程优化建议

2. **敏感数据分级智能优化**
   - 基于机器学习智能优化敏感数据分级规则
   - 支持敏感数据分级模型自动训练
   - 支持敏感数据分级模型自动部署
   - 支持敏感数据分级模型自动监控

3. **安全策略智能管理**
   - 基于 AI 智能管理安全策略
   - 支持安全策略自动生成
   - 支持安全策略自动优化
   - 支持安全策略自动监控

4. **用户体验智能优化**
   - 基于用户行为智能优化控制台界面
   - 支持个性化审批流程推荐
   - 支持个性化审批流程提醒
   - 支持个性化审批流程建议

### 改进

1. **改进审批流程智能推荐**
   - 优化推荐算法
   - 优化相似度分析
   - 优化预测分析
   - 优化优化建议

2. **改进敏感数据分级智能优化**
   - 优化机器学习算法
   - 优化模型自动训练
   - 优化模型自动部署
   - 优化模型自动监控

3. **改进安全策略智能管理**
   - 优化 AI 算法
   - 优化自动生成
   - 优化自动优化
   - 优化自动监控

4. **改进用户体验智能优化**
   - 优化用户行为分析
   - 优化个性化推荐
   - 优化个性化提醒
   - 优化个性化建议

### 修复

1. **修复审批流程智能推荐时的错误**
   - 修复推荐算法逻辑
   - 修复相似度分析逻辑
   - 修复预测分析逻辑
   - 修复优化建议逻辑

2. **修复敏感数据分级智能优化时的错误**
   - 修复机器学习算法逻辑
   - 修复模型自动训练逻辑
   - 修复模型自动部署逻辑
   - 修复模型自动监控逻辑

3. **修复安全策略智能管理时的错误**
   - 修复 AI 算法逻辑
   - 修复自动生成逻辑
   - 修复自动优化逻辑
   - 修复自动监控逻辑

4. **修复用户体验智能优化时的错误**
   - 修复用户行为分析逻辑
   - 修复个性化推荐逻辑
   - 修复个性化提醒逻辑
   - 修复个性化建议逻辑

## v1.5.1 (2024-06-15)

### 修复

1. **修复审批流程智能推荐时的错误**
   - 修复推荐数据逻辑
   - 修复推荐计算逻辑
   - 修复推荐展示逻辑

2. **修复敏感数据分级智能优化时的错误**
   - 修复机器学习数据逻辑
   - 修复机器学习计算逻辑
   - 修复机器学习展示逻辑

3. **修复安全策略智能管理时的错误**
   - 修复 AI 数据逻辑
   - 修复 AI 计算逻辑
   - 修复 AI 展示逻辑

4. **修复用户体验智能优化时的错误**
   - 修复用户行为数据逻辑
   - 修复用户行为计算逻辑
   - 修复用户行为展示逻辑

### 改进

1. **改进审批流程智能推荐**
   - 优化推荐数据
   - 优化推荐计算
   - 优化推荐展示
   - 优化推荐监控

2. **改进敏感数据分级智能优化**
   - 优化机器学习数据
   - 优化机器学习计算
   - 优化机器学习展示
   - 优化机器学习监控

3. **改进安全策略智能管理**
   - 优化 AI 数据
   - 优化 AI 计算
   - 优化 AI 展示
   - 优化 AI 监控

4. **改进用户体验智能优化**
   - 优化用户行为数据
   - 优化用户行为计算
   - 优化用户行为展示
   - 优化用户行为监控

---

## 联系方式

- **项目主页**：https://github.com/bytebase/bytebase
- **问题反馈**：https://github.com/bytebase/bytebase/issues
- **贡献指南**：CONTRIBUTING_SENSITIVE_DATA.md
- **许可证**：LICENSE_SENSITIVE_DATA.md

---

## 致谢

感谢所有为敏感数据分级与审批流功能做出贡献的开发者！