- statement: |-
    CREATE TABLE "user"(
            id INT,
            name VARCHAR(255) NOT NULL,
            room_id INT NOT NULL,
            creator_id INT NOT NULL,
            created_ts TIMESTAMP NOT NULL,
            updater_id INT NOT NULL,
            updated_ts TIMESTAMP NOT NULL,
            CONSTRAINT pk_user_id PRIMARY KEY (id),
            CONSTRAINT uk_user_id_name UNIQUE (id, name)
            );
    COMMENT ON TABLE "user" IS 'User table';
  result:
    - |-
      {
        "status":  "SUCCESS",
        "title":  "OK"
      }
  run: false
- statement: CREATE TABLE user(id);
  result:
    - |-
      {
        "status":  "ERROR",
        "title":  "Syntax error",
        "content":  "Syntax error at line 1:14 \nrelated text: CREATE TABLE user",
        "code":  201,
        "sqlReviewReport":  {
          "startPosition":  {
            "line":  1,
            "column":  14
          }
        }
      }
  run: false
- statement: |-
    CREATE TABLE "userTable"(
            id INT,
            name VARCHAR(255),
            "roomId" INT,
            CONSTRAINT uk1 UNIQUE (id, name),
            CONSTRAINT fk1 FOREIGN KEY ("roomId") REFERENCES room(id)
            );
    COMMENT ON TABLE "userTable" IS 'User table';
  result:
    - |-
      {
        "status":  "ERROR",
        "title":  "TABLE_REQUIRE_PK",
        "content":  "Table \"public\".\"userTable\" requires PRIMARY KEY, related statement: \"CREATE TABLE \\\"userTable\\\"(\\n        id INT,\\n        name VARCHAR(255),\\n        \\\"roomId\\\" INT,\\n        CONSTRAINT uk1 UNIQUE (id, name),\\n        CONSTRAINT fk1 FOREIGN KEY (\\\"roomId\\\") REFERENCES room(id)\\n        )\"",
        "code":  601,
        "sqlReviewReport":  {
          "startPosition":  {
            "line":  1
          }
        }
      }
    - |-
      {
        "status":  "ERROR",
        "title":  "TABLE_NO_FOREIGN_KEY",
        "content":  "Foreign key is not allowed in the table \"public\".\"userTable\", related statement: \"CREATE TABLE \"userTable\"(\n        id INT,\n        name VARCHAR(255),\n        \"roomId\" INT,\n        CONSTRAINT uk1 UNIQUE (id, name),\n        CONSTRAINT fk1 FOREIGN KEY (\"roomId\") REFERENCES room(id)\n        )\"",
        "code":  602,
        "sqlReviewReport":  {
          "startPosition":  {
            "line":  1
          }
        }
      }
    - |-
      {
        "status":  "WARNING",
        "title":  "NAMING_TABLE",
        "content":  "\"userTable\" mismatches table naming convention, naming format should be \"^[a-z]+(_[a-z]+)*$\"",
        "code":  301,
        "sqlReviewReport":  {
          "startPosition":  {
            "line":  1
          }
        }
      }
    - |-
      {
        "status":  "WARNING",
        "title":  "NAMING_COLUMN",
        "content":  "\"userTable\".\"roomId\" mismatches column naming convention, naming format should be \"^[a-z]+(_[a-z]+)*$\"",
        "code":  302,
        "sqlReviewReport":  {
          "startPosition":  {
            "line":  4
          }
        }
      }
    - |-
      {
        "status":  "WARNING",
        "title":  "NAMING_INDEX_UK",
        "content":  "Unique key in table \"userTable\" mismatches the naming convention, expect \"^$|^uk_userTable_id_name$\" but found \"uk1\"",
        "code":  304,
        "sqlReviewReport":  {
          "startPosition":  {
            "line":  5
          }
        }
      }
    - |-
      {
        "status":  "WARNING",
        "title":  "NAMING_INDEX_FK",
        "content":  "Foreign key in table \"userTable\" mismatches the naming convention, expect \"^$|^fk_userTable_roomId_room_id$\" but found \"fk1\"",
        "code":  305,
        "sqlReviewReport":  {
          "startPosition":  {
            "line":  1
          }
        }
      }
    - |-
      {
        "status":  "WARNING",
        "title":  "COLUMN_REQUIRED",
        "content":  "Table \"userTable\" requires columns: created_ts, creator_id, updated_ts, updater_id",
        "code":  401,
        "sqlReviewReport":  {
          "startPosition":  {
            "line":  1
          }
        }
      }
    - |-
      {
        "status":  "WARNING",
        "title":  "COLUMN_NO_NULL",
        "content":  "Column \"id\" in \"public\".\"userTable\" cannot have NULL value",
        "code":  402,
        "sqlReviewReport":  {
          "startPosition":  {
            "line":  2
          }
        }
      }
    - |-
      {
        "status":  "WARNING",
        "title":  "COLUMN_NO_NULL",
        "content":  "Column \"name\" in \"public\".\"userTable\" cannot have NULL value",
        "code":  402,
        "sqlReviewReport":  {
          "startPosition":  {
            "line":  3
          }
        }
      }
    - |-
      {
        "status":  "WARNING",
        "title":  "COLUMN_NO_NULL",
        "content":  "Column \"roomId\" in \"public\".\"userTable\" cannot have NULL value",
        "code":  402,
        "sqlReviewReport":  {
          "startPosition":  {
            "line":  4
          }
        }
      }
  run: false
- statement: DELETE FROM t
  result:
    - |-
      {
        "status":  "ERROR",
        "title":  "STATEMENT_WHERE_REQUIRE_UPDATE_DELETE",
        "content":  "\"DELETE FROM t\" requires WHERE clause",
        "code":  202,
        "sqlReviewReport":  {
          "startPosition":  {
            "line":  1
          }
        }
      }
  run: false
- statement: DELETE FROM t WHERE a like '%abc'
  result:
    - |-
      {
        "status":  "ERROR",
        "title":  "STATEMENT_WHERE_NO_LEADING_WILDCARD_LIKE",
        "content":  "\"DELETE FROM t WHERE a like '%abc'\" uses leading wildcard LIKE",
        "code":  204,
        "sqlReviewReport":  {
          "startPosition":  {
            "line":  1
          }
        }
      }
  run: false
- statement: DELETE FROM t WHERE a = (SELECT max(id) FROM "user" WHERE name = 'bytebase')
  result:
    - |-
      {
        "status":  "SUCCESS",
        "title":  "OK"
      }
  run: false
- statement: INSERT INTO t VALUES (1), (2)
  result:
    - |-
      {
        "status":  "SUCCESS",
        "title":  "OK"
      }
  run: false
- statement: |-
    CREATE TABLE tech_book(
      id int,
      creator_id INT NOT NULL,
      created_ts TIMESTAMP NOT NULL,
      updater_id INT NOT NULL,
      updated_ts TIMESTAMP NOT NULL,
      CONSTRAINT pk_tech_book_id PRIMARY KEY (id)
    );
    COMMENT ON TABLE tech_book IS 'tech_book';
  result:
    - |-
      {
        "status":  "SUCCESS",
        "title":  "OK"
      }
  run: true
- statement: ALTER INDEX pk_tech_book_id RENAME TO pk1
  result:
    - |-
      {
        "status":  "WARNING",
        "title":  "NAMING_INDEX_PK",
        "content":  "Primary key in table \"tech_book\" mismatches the naming convention, expect \"^$|^pk_tech_book_id$\" but found \"pk1\"",
        "code":  306,
        "sqlReviewReport":  {
          "startPosition":  {
            "line":  1
          }
        }
      }
    - |-
      {
        "status":  "WARNING",
        "title":  "SCHEMA_BACKWARD_COMPATIBILITY",
        "content":  "\"ALTER INDEX pk_tech_book_id RENAME TO pk1\" may cause incompatibility with the existing data and code",
        "code":  102,
        "sqlReviewReport":  {
          "startPosition":  {
            "line":  1
          }
        }
      }
  run: false
