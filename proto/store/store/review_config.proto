syntax = "proto3";

package bytebase.store;

import "store/common.proto";

option go_package = "generated-go/store";

message ReviewConfigPayload {
  repeated SQLReviewRule sql_review_rules = 1;
}

message SQLReviewRule {
  // Payload message types for SQL review rules
  message NamingRulePayload {
    int32 max_length = 1;
    string format = 2;
  }

  message NumberRulePayload {
    int32 number = 1;
  }

  message StringArrayRulePayload {
    repeated string list = 1;
  }

  message CommentConventionRulePayload {
    bool required = 1;
    int32 max_length = 2;
  }

  message StringRulePayload {
    string value = 1;
  }

  message NamingCaseRulePayload {
    bool upper = 1;
  }

  // The severity level for SQL review rules.
  enum Level {
    // Unspecified level.
    LEVEL_UNSPECIFIED = 0;
    // Rule violation is an error.
    ERROR = 1;
    // Rule violation is a warning.
    WARNING = 2;
  }

  enum Type {
    TYPE_UNSPECIFIED = 0;
    ENGINE_MYSQL_USE_INNODB = 1;
    NAMING_FULLY_QUALIFIED = 2;
    NAMING_TABLE = 3;
    NAMING_COLUMN = 4;
    NAMING_INDEX_PK = 5;
    NAMING_INDEX_UK = 6;
    NAMING_INDEX_FK = 7;
    NAMING_INDEX_IDX = 8;
    NAMING_COLUMN_AUTO_INCREMENT = 9;
    NAMING_TABLE_NO_KEYWORD = 10;
    NAMING_IDENTIFIER_NO_KEYWORD = 11;
    NAMING_IDENTIFIER_CASE = 12;
    STATEMENT_SELECT_NO_SELECT_ALL = 13;
    STATEMENT_WHERE_REQUIRE_SELECT = 14;
    STATEMENT_WHERE_REQUIRE_UPDATE_DELETE = 15;
    STATEMENT_WHERE_NO_LEADING_WILDCARD_LIKE = 16;
    STATEMENT_DISALLOW_ON_DEL_CASCADE = 17;
    STATEMENT_DISALLOW_RM_TBL_CASCADE = 18;
    STATEMENT_DISALLOW_COMMIT = 19;
    STATEMENT_DISALLOW_LIMIT = 20;
    STATEMENT_DISALLOW_ORDER_BY = 21;
    STATEMENT_MERGE_ALTER_TABLE = 22;
    STATEMENT_INSERT_ROW_LIMIT = 23;
    STATEMENT_INSERT_MUST_SPECIFY_COLUMN = 24;
    STATEMENT_INSERT_DISALLOW_ORDER_BY_RAND = 25;
    STATEMENT_AFFECTED_ROW_LIMIT = 26;
    STATEMENT_DML_DRY_RUN = 27;
    STATEMENT_DISALLOW_ADD_COLUMN_WITH_DEFAULT = 28;
    STATEMENT_ADD_CHECK_NOT_VALID = 29;
    STATEMENT_ADD_FOREIGN_KEY_NOT_VALID = 30;
    STATEMENT_DISALLOW_ADD_NOT_NULL = 31;
    STATEMENT_SELECT_FULL_TABLE_SCAN = 32;
    STATEMENT_CREATE_SPECIFY_SCHEMA = 33;
    STATEMENT_CHECK_SET_ROLE_VARIABLE = 34;
    STATEMENT_DISALLOW_USING_FILESORT = 35;
    STATEMENT_DISALLOW_USING_TEMPORARY = 36;
    STATEMENT_WHERE_NO_EQUAL_NULL = 37;
    STATEMENT_WHERE_DISALLOW_FUNCTIONS_AND_CALCULATIONS = 38;
    STATEMENT_QUERY_MINIMUM_PLAN_LEVEL = 39;
    STATEMENT_WHERE_MAXIMUM_LOGICAL_OPERATOR_COUNT = 40;
    STATEMENT_MAXIMUM_LIMIT_VALUE = 41;
    STATEMENT_MAXIMUM_JOIN_TABLE_COUNT = 42;
    STATEMENT_MAXIMUM_STATEMENTS_IN_TRANSACTION = 43;
    STATEMENT_JOIN_STRICT_COLUMN_ATTRS = 44;
    STATEMENT_NON_TRANSACTIONAL = 45;
    STATEMENT_ADD_COLUMN_WITHOUT_POSITION = 46;
    STATEMENT_DISALLOW_OFFLINE_DDL = 47;
    STATEMENT_DISALLOW_CROSS_DB_QUERIES = 48;
    STATEMENT_MAX_EXECUTION_TIME = 49;
    STATEMENT_REQUIRE_ALGORITHM_OPTION = 50;
    STATEMENT_REQUIRE_LOCK_OPTION = 51;
    STATEMENT_OBJECT_OWNER_CHECK = 52;
    TABLE_REQUIRE_PK = 53;
    TABLE_NO_FOREIGN_KEY = 54;
    TABLE_DROP_NAMING_CONVENTION = 55;
    TABLE_COMMENT = 56;
    TABLE_DISALLOW_PARTITION = 57;
    TABLE_DISALLOW_TRIGGER = 58;
    TABLE_NO_DUPLICATE_INDEX = 59;
    TABLE_TEXT_FIELDS_TOTAL_LENGTH = 60;
    TABLE_DISALLOW_SET_CHARSET = 61;
    TABLE_DISALLOW_DDL = 62;
    TABLE_DISALLOW_DML = 63;
    TABLE_LIMIT_SIZE = 64;
    TABLE_REQUIRE_CHARSET = 65;
    TABLE_REQUIRE_COLLATION = 66;
    COLUMN_REQUIRED = 67;
    COLUMN_NO_NULL = 68;
    COLUMN_DISALLOW_CHANGE_TYPE = 69;
    COLUMN_SET_DEFAULT_FOR_NOT_NULL = 70;
    COLUMN_DISALLOW_CHANGE = 71;
    COLUMN_DISALLOW_CHANGING_ORDER = 72;
    COLUMN_DISALLOW_DROP = 73;
    COLUMN_DISALLOW_DROP_IN_INDEX = 74;
    COLUMN_COMMENT = 75;
    COLUMN_AUTO_INCREMENT_MUST_INTEGER = 76;
    COLUMN_TYPE_DISALLOW_LIST = 77;
    COLUMN_DISALLOW_SET_CHARSET = 78;
    COLUMN_MAXIMUM_CHARACTER_LENGTH = 79;
    COLUMN_MAXIMUM_VARCHAR_LENGTH = 80;
    COLUMN_AUTO_INCREMENT_INITIAL_VALUE = 81;
    COLUMN_AUTO_INCREMENT_MUST_UNSIGNED = 82;
    COLUMN_CURRENT_TIME_COUNT_LIMIT = 83;
    COLUMN_REQUIRE_DEFAULT = 84;
    COLUMN_DEFAULT_DISALLOW_VOLATILE = 85;
    COLUMN_ADD_NOT_NULL_REQUIRE_DEFAULT = 86;
    COLUMN_REQUIRE_CHARSET = 87;
    COLUMN_REQUIRE_COLLATION = 88;
    SCHEMA_BACKWARD_COMPATIBILITY = 89;
    DATABASE_DROP_EMPTY_DATABASE = 90;
    INDEX_NO_DUPLICATE_COLUMN = 91;
    INDEX_KEY_NUMBER_LIMIT = 92;
    INDEX_PK_TYPE_LIMIT = 93;
    INDEX_TYPE_NO_BLOB = 94;
    INDEX_TOTAL_NUMBER_LIMIT = 95;
    INDEX_PRIMARY_KEY_TYPE_ALLOWLIST = 96;
    INDEX_CREATE_CONCURRENTLY = 97;
    INDEX_TYPE_ALLOW_LIST = 98;
    INDEX_NOT_REDUNDANT = 99;
    SYSTEM_CHARSET_ALLOWLIST = 100;
    SYSTEM_COLLATION_ALLOWLIST = 101;
    SYSTEM_COMMENT_LENGTH = 102;
    SYSTEM_PROCEDURE_DISALLOW_CREATE = 103;
    SYSTEM_EVENT_DISALLOW_CREATE = 104;
    SYSTEM_VIEW_DISALLOW_CREATE = 105;
    SYSTEM_FUNCTION_DISALLOW_CREATE = 106;
    SYSTEM_FUNCTION_DISALLOWED_LIST = 107;
    ADVICE_ONLINE_MIGRATION = 108;
    BUILTIN_PRIOR_BACKUP_CHECK = 109;
  }

  Type type = 1;
  Level level = 2;

  oneof payload {
    NamingRulePayload naming_payload = 3;
    NumberRulePayload number_payload = 4;
    StringArrayRulePayload string_array_payload = 5;
    CommentConventionRulePayload comment_convention_payload = 6;
    StringRulePayload string_payload = 7;
    NamingCaseRulePayload naming_case_payload = 8;
  }

  Engine engine = 9;
}
