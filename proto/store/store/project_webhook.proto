syntax = "proto3";

package bytebase.store;

import "store/common.proto";

option go_package = "generated-go/store";

// Activity types for webhook notifications.
message Activity {
  // Activity type enumeration.
  enum Type {
    // Unspecified type.
    TYPE_UNSPECIFIED = 0;
    // ISSUE_CREATED represents a new issue creation event.
    ISSUE_CREATED = 10;
    // ISSUE_APPROVAL_REQUESTED represents an approval request event.
    ISSUE_APPROVAL_REQUESTED = 11;
    // ISSUE_SENT_BACK represents an issue being sent back by an approver.
    ISSUE_SENT_BACK = 12;
    // PIPELINE_FAILED represents a pipeline failure event.
    PIPELINE_FAILED = 13;
    // PIPELINE_COMPLETED represents a pipeline completion event.
    PIPELINE_COMPLETED = 14;
  }
}

message ProjectWebhook {
  // Webhook type.
  WebhookType type = 1;
  // Webhook title.
  string title = 2;
  // Webhook URL.
  string url = 3;
  // List of activities that trigger this webhook.
  repeated Activity.Type activities = 4;
  // If direct_message is set, the notification is sent directly
  // to the persons and url will be ignored.
  // IM integration setting should be set for this function to work.
  bool direct_message = 5;
}
