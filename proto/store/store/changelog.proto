syntax = "proto3";

package bytebase.store;

option go_package = "generated-go/store";

message ChangelogPayload {
  // Format: projects/{project}/plans/{plan}/rollout/stages/{stage}/tasks/{task}/taskRuns/{taskRun}
  string task_run = 1;

  // The revision uid.
  // optional
  int64 revision = 2;

  // The SHA256 hash of the sheet content (hex-encoded).
  string sheet_sha256 = 3;

  string version = 4;

  enum Type {
    TYPE_UNSPECIFIED = 0;
    BASELINE = 1;
    MIGRATE = 2;
    SDL = 3;
  }
  Type type = 5;

  string git_commit = 6;

  // Dump format version for drift detection reliability.
  // Engine-specific version stored when baseline/migration is created.
  // 0 = legacy changelog (pre-versioning).
  int32 dump_version = 7;
}
